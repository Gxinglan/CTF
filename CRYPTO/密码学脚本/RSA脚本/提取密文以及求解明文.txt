#一、
from Crypto.PublicKey import RSA
import gmpy2,rsa,base64
n =  833810193564967701912362955539789451139872863794534923259743419423089229206473091408403560311191545764221310666338878019
e =  65537
p = 863653476616376575308866344984576466644942572246900013156919
q = 965445304326998194798282228842484732438457170595999523426901
phi_n = (p - 1) * (q - 1)
d = gmpy2.invert(e, phi_n)
priv = rsa.PrivateKey(n, e, d, p, q)
with open("./flag.b64", "rb") as file:
    cipher = file.read()
cipher = base64.b64decode(cipher)#如果不是base64就删去
flag = rsa.decrypt(cipher, priv).decode()
print(flag)
#二
from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_OAEP
import libnum
n = 10306247299477991196335954707897189353577589618180446614762218980226685668311143526740800444344046158260556585833057716406703213966249956775927205061731821632025483608182881492214855240841820024816859031176291364212054293818204399157346955465232586109199762630150640804366966946066155685218609638749171632685073
e = 65537
p = 97
q = 106249972159566919549855203174197828387397831115262336234662051342543151219702510584956705611794290291345944183845955839244363030579896461607496959399297130227066841321473005074379950936513608503266587950271044991876848389878395867601515004796212227929894460104645781488319246866661398816686697306692491058609
phi=(p-1)*(q-1)
d = libnum.invmod(e,phi)
rsakey = RSA.importKey(open('public.key', 'r').read())
privatekey = RSA.construct((n,e,d,p,q))
rsa = PKCS1_OAEP.new(privatekey)
m = rsa.decrypt(open('flag.enc', 'rb').read())
print(m)